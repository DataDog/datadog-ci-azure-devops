{
  "id": "60b18503-c6d6-4e4b-a6b2-52fc6fb3d525",
  "name": "SyntheticsRunTests",
  "author": "Datadog",
  "friendlyName": "Datadog Synthetic Tests",
  "description": "Run Datadog Synthetic tests as part of your Azure pipelines",
  "releaseNotes": "Run Datadog Synthetics CI tests as part of your Azure pipelines",
  "category": "Test",
  "version": {
    "Major": 2,
    "Minor": 2,
    "Patch": 0
  },
  "preview": true,
  "instanceNameFormat": "Run Datadog Synthetics CI tests",
  "inputs": [
    {
      "name": "authenticationType",
      "type": "radio",
      "label": "Choose an authentication type",
      "defaultValue": "apiAppKeys",
      "helpMarkDown": "How to store and retrieve credentials.",
      "required": true,
      "options": {
        "connectedService": "Use a Service Connection",
        "apiAppKeys": "Use API & Application keys"
      }
    },
    {
      "name": "apiKey",
      "type": "string",
      "label": "Datadog API key",
      "defaultValue": "",
      "helpMarkDown": "Your Datadog API key. This key is [created in your Datadog organization](https://docs.datadoghq.com/account_management/api-app-keys/) and should be stored as a [secret](https://docs.microsoft.com/en-us/azure/devops/pipelines/process/set-secret-variables).",
      "required": true,
      "visibleRule": "authenticationType = apiAppKeys"
    },
    {
      "name": "appKey",
      "type": "string",
      "label": "Datadog Application key",
      "defaultValue": "",
      "helpMarkDown": "Your Datadog application key. This key is [created in your Datadog organization](https://docs.datadoghq.com/account_management/api-app-keys/) and should be stored as a [secret](https://docs.microsoft.com/en-us/azure/devops/pipelines/process/set-secret-variables).",
      "required": true,
      "visibleRule": "authenticationType = apiAppKeys"
    },
    {
      "name": "batchTimeout",
      "type": "int",
      "label": "Batch Timeout",
      "defaultValue": "",
      "helpMarkDown": "The duration in milliseconds after which the CI batch fails as timed out. This does not affect the outcome of a test run that already started."
    },
    {
      "name": "connectedService",
      "type": "connectedService:datadog-ci",
      "label": "Datadog CI service connection",
      "defaultValue": "",
      "helpMarkDown": "Select a Datadog CI service connection.",
      "required": true,
      "visibleRule": "authenticationType = connectedService"
    },
    {
      "name": "configPath",
      "type": "filePath",
      "label": "Global Configuration File",
      "defaultValue": "",
      "helpMarkDown": "The path to the [global configuration file](https://docs.datadoghq.com/continuous_testing/cicd_integrations/configuration/?tab=npm#global-configuration-file) that configures datadog-ci."
    },
    {
      "name": "datadogSite",
      "type": "string",
      "label": "Datadog Site",
      "defaultValue": "datadoghq.com",
      "helpMarkDown": "Your Datadog site. The possible values are listed [in this table](https://docs.datadoghq.com/getting_started/site/#access-the-datadog-site).",
      "visibleRule": "authenticationType = apiAppKeys"
    },
    {
      "name": "failOnCriticalErrors",
      "type": "boolean",
      "label": "Fail On Critical Errors",
      "defaultValue": "",
      "helpMarkDown": "Fail the CI job if a critical error that is typically transient occurs, such as rate limits, authentication failures, or Datadog infrastructure issues."
    },
    {
      "name": "failOnMissingTests",
      "type": "boolean",
      "label": "Fail on missing tests",
      "defaultValue": "",
      "helpMarkDown": "Fail the CI job if at least one specified test with a public ID (using `publicIds` or listed in a [test file](https://docs.datadoghq.com/continuous_testing/cicd_integrations/configuration/?tab=npm#test-files)) is missing in a run (for example, if it has been deleted programmatically or on the Datadog site)."
    },
    {
      "name": "failOnTimeout",
      "type": "boolean",
      "label": "Fail on timeout",
      "defaultValue": "",
      "helpMarkDown": "Fail the CI job if at least one test exceeds the default test timeout."
    },
    {
      "name": "files",
      "type": "multiLine",
      "label": "Synthetic test config files",
      "defaultValue": "",
      "helpMarkDown": "Glob pattern to detect Synthetic tests config files."
    },
    {
      "name": "jUnitReport",
      "type": "string",
      "label": "JUnit Report",
      "defaultValue": "",
      "helpMarkDown": "The filename for a JUnit report if you want to generate one."
    },
    {
      "name": "publicIds",
      "type": "multiLine",
      "label": "Synthetic test IDs",
      "defaultValue": "",
      "helpMarkDown": "Public IDs of Synthetic tests to run, separated by new lines or commas. If no value is provided, tests are discovered in `*.synthetics.json` files."
    },
    {
      "name": "subdomain",
      "type": "string",
      "label": "Custom Subdomain",
      "defaultValue": "app",
      "helpMarkDown": "The name of the custom subdomain set to access your Datadog application. If the URL used to access Datadog is `myorg.datadoghq.com`, this value needs to be set to `myorg`.",
      "visibleRule": "authenticationType = apiAppKeys"
    },
    {
      "name": "testSearchQuery",
      "type": "string",
      "label": "Test search query",
      "defaultValue": "",
      "helpMarkDown": "Trigger tests corresponding to a [search](https://docs.datadoghq.com/synthetics/search/#search) query. This can be useful if you are tagging your test configurations. See [best practices](https://docs.datadoghq.com/developers/guide/what-best-practices-are-recommended-for-naming-metrics-and-tags/#rules-and-best-practices-for-naming-tags) for more information on tagging."
    },
    {
      "name": "variables",
      "type": "multiLine",
      "label": "Variables",
      "defaultValue": "",
      "helpMarkDown": "Key-value pairs for injecting variables into tests, separated by newlines or commas. For example: `START_URL=https://example.org,MY_VARIABLE=My title`."
    }
  ],
  "execution": {
    "Node20_1": {
      "target": "task.js"
    },
    "Node16": {
      "target": "task.node16.js"
    },
    "Node10": {
      "target": "task.node10.js"
    }
  }
}
